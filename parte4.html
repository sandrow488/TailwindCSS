<!doctype html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Parte 4 — Motor y tokens</title>
  <link href="/src/style.css" rel="stylesheet" />
</head>

<body class="bg-gray-50 text-gray-800 dark:bg-gray-950 dark:text-gray-100">
  <header class="max-w-5xl mx-auto p-4 flex items-center justify-between">
    <a class="text-xl font-bold text-brand" href="/">Tailwind v4.1 — Tutorial</a>
    <div class="md:hidden">
      <button id="menu-btn" class="text-gray-600 hover:text-gray-800 focus:outline-none" aria-label="Abrir menú">
        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
        </svg>
      </button>
    </div>
    <nav id="menu" class="hidden md:flex text-sm flex-col md:flex-row items-center">
      <a class="px-2 py-1 md:py-0 hover:underline" href="/index.html">Index</a>
      <a class="px-2 py-1 md:py-0 hover:underline" href="/parte1.html">Parte 1</a>
      <a class="px-2 py-1 md:py-0 hover:underline" href="/parte2.html">Parte 2</a>
      <a class="px-2 py-1 md:py-0 hover:underline" href="/parte3.html">Parte 3</a>
      <a class="px-2 py-1 md:py-0 hover:underline" href="/parte4.html">Parte 4</a>
      <a class="px-2 py-1 md:py-0 hover:underline" href="/parte5.html">Parte 5</a>
      <a class="px-2 py-1 md:py-0 hover:underline" href="/parte6.html">Parte 6</a>
      <a class="px-2 py-1 md:py-0 hover:underline" href="/parte7.html">Parte 7</a>
      <a class="px-2 py-1 md:py-0 hover:underline" href="/parte8.html">Parte 8</a>
      <a class="px-2 py-1 md:py-0 hover:underline" href="/parte9.html">Parte 9</a>
      <a class="px-2 py-1 md:py-0 hover:underline" href="/parte10.html">Parte 10</a>
    </nav>
  </header>

  <main class="max-w-5xl mx-auto p-4 space-y-8">
    <section>
      <h1 class="text-3xl font-bold">Parte 4 — Motor de Tailwind y tokens del tema</h1>
      <p class="mt-2 text-gray-600 dark:text-gray-300">
        Tailwind v4.1 escanea tu código y genera solo el CSS de las clases que realmente usas. Con
        <code>@theme</code> defines tus “tokens” (colores, radios, sombras…) y se exponen como utilidades
        (<code>text-brand</code>, <code>bg-brand</code>, etc.). Para patrones reusables, declara clases en
        <code>@layer components</code> y compón utilidades con <code>@apply</code>.
      </p>
      <p class="mt-2 text-xs text-gray-500 dark:text-gray-400">
        Referencias oficiales:
        <a class="underline" href="https://tailwindcss.com/docs/installation" target="_blank" rel="noreferrer">Installation</a>,
        <a class="underline" href="https://tailwindcss.com/docs/utility-first" target="_blank" rel="noreferrer">Utility-first</a>,
        <a class="underline" href="https://tailwindcss.com/docs/dark-mode" target="_blank" rel="noreferrer">Dark mode</a>,
        <a class="underline" href="https://tailwindcss.com/docs/hover-focus-and-other-states" target="_blank" rel="noreferrer">Hover, focus &amp; other states</a>,
        <a class="underline" href="https://tailwindcss.com/docs/adding-custom-styles" target="_blank" rel="noreferrer">Adding custom styles</a>,
        <a class="underline" href="https://tailwindcss.com/docs/adding-custom-styles#theme" target="_blank" rel="noreferrer">Theme variables</a>,
        <a class="underline" href="https://tailwindcss.com/docs/adding-custom-styles#using-apply" target="_blank" rel="noreferrer">Using @apply</a>,
        <a class="underline" href="https://tailwindcss.com/docs/adding-custom-styles#using-arbitrary-values" target="_blank" rel="noreferrer">Using arbitrary values</a>.
      </p>
    </section>

    <!-- Paso 1 -->
    <section class="card">
      <h2 class="card-title">Paso 1 — Componentes con <code>@apply</code> (en <code>@layer components</code>)</h2>
      <p class="text-sm text-gray-600 dark:text-gray-300">
        Crearás una base de botón reutilizable y su variante de marca. Esto te evita repetir largas listas de utilidades
        en cada HTML y mantiene el diseño consistente.
      </p>
      <div class="flex gap-3 mt-3">
        <button class="btn">Base (.btn)</button>
        <button class="btn btn-brand">Marca (.btn-brand)</button>
      </div>
      <p class="mt-3 text-sm text-gray-600 dark:text-gray-300">
        Abre <code>src/style.css</code> y revisa cómo se definen <code>.btn</code> y <code>.btn-brand</code> en
        <code>@layer components</code> con <code>@apply</code>. Los colores salen de <code>@theme</code>.
      </p>
      <pre class="mt-3 p-4 bg-gray-100 dark:bg-gray-900 rounded text-xs overflow-x-auto"><code>/* src/style.css (resumen) */
@import "tailwindcss";

/* Tokens del tema (expone text-brand, bg-brand, etc.) */
@layer theme {
  @theme { --color-brand: #2563eb; }
}

/* Componentes reusables */
@layer components {
  .btn {
    @apply inline-flex items-center justify-center px-4 py-2 rounded font-medium
           shadow-sm transition
           focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-brand;
  }
  .btn-brand {
    @apply bg-brand text-white hover:bg-brand/90;
  }
}
</code></pre>
      <p class="mt-2 text-xs text-gray-500 dark:text-gray-400">
        Docs: <a class="underline" href="https://tailwindcss.com/docs/adding-custom-styles#theme" target="_blank" rel="noreferrer">Theme variables</a> ·
        <a class="underline" href="https://tailwindcss.com/docs/adding-custom-styles#using-apply" target="_blank" rel="noreferrer">Using @apply</a>
      </p>
    </section>

    <!-- Paso 2 -->
    <section class="card">
      <h2 class="card-title">Paso 2 — Componer utilidades (filtros encadenados)</h2>
      <p class="text-sm text-gray-600 dark:text-gray-300">
        Encadena utilidades como <code>blur-sm</code> y <code>grayscale</code> y añade interacción con
        <code>hover:</code>. No necesitas CSS manual para efectos comunes.
      </p>
      <div class="rounded overflow-hidden transition-all duration-300
                  blur-sm grayscale hover:blur-0 hover:grayscale-0">
        <img src="https://picsum.photos/800/300" alt="Ejemplo de composición de filtros" />
      </div>
      <p class="mt-2 text-xs text-gray-500 dark:text-gray-400">
        Docs: <a class="underline" href="https://tailwindcss.com/docs/filters" target="_blank" rel="noreferrer">Filters</a> ·
        <a class="underline" href="https://tailwindcss.com/docs/hover-focus-and-other-states" target="_blank" rel="noreferrer">Hover &amp; focus</a>
      </p>
    </section>

    <!-- Paso 3 -->
    <section class="card">
      <h2 class="card-title">Paso 3 — Valores arbitrarios y funciones</h2>
      <p class="text-sm text-gray-600 dark:text-gray-300">
        Cuando la escala no tiene el valor que necesitas, usa la notación de corchetes. Puedes combinar
        <code>calc()</code> y helpers del tema como <code>--spacing()</code> para cálculos dinámicos.
      </p>
      <div class="rounded bg-white dark:bg-slate-900 p-4
                  max-h-[calc(50vh-(--spacing(10)))] overflow-y-auto">
        <p class="text-sm text-gray-600 dark:text-gray-300">
          Este contenedor limita su altura con un cálculo dinámico usando un valor arbitrario.
        </p>
        <div class="h-[600px]"></div>
      </div>
      <p class="mt-2 text-xs text-gray-500 dark:text-gray-400">
        Docs: <a class="underline" href="https://tailwindcss.com/docs/adding-custom-styles#using-arbitrary-values" target="_blank" rel="noreferrer">Using arbitrary values</a>
      </p>
    </section>

    <!-- Paso 4 -->
    <section class="card">
      <h2 class="card-title">Paso 4 — ¿Cómo detecta Tailwind las clases?</h2>
      <p class="text-sm text-gray-700 dark:text-gray-300">
        El motor detecta clases cuando aparecen como <em>cadenas completas</em> en tu código. Evita “fabricar” nombres
        de clase con concatenaciones que el escáner no pueda ver.
      </p>
      <pre class="mt-3 p-4 bg-gray-100 dark:bg-gray-900 rounded text-xs overflow-x-auto"><code>// Ejemplo React: cadenas planas y condiciones simples
export default function Button({ size = "md", active = false, children }) {
  const sizeClasses = {
    sm: "px-2 py-1 text-sm",
    md: "px-4 py-2 text-base",
    lg: "px-6 py-3 text-lg",
  }[size];

  return (
    &lt;button
      className={`bg-brand text-white rounded hover:bg-brand/90 ${sizeClasses} ${active ? "ring-2 ring-brand" : ""}`}
    &gt;
      {children}
    &lt;/button&gt;
  );
}
</code></pre>
      <p class="mt-2 text-xs text-gray-500 dark:text-gray-400">
        Docs: <a class="underline" href="https://tailwindcss.com/docs/content-configuration#class-detection-in-depth" target="_blank" rel="noreferrer">Detecting classes in source files</a>
      </p>
    </section>

    <!-- Ejercicio guiado (ampliado y con enlaces) -->
    <section class="card">
      <h2 class="card-title">Ejercicio guiado — Mini biblioteca de estilos (v4.1)</h2>
      <p class="text-sm text-gray-600 dark:text-gray-300">
        Objetivo: crear tokens de marca con <code>@theme</code> y dos componentes reutilizables en
        <code>@layer components</code>. Después, aplicarás la biblioteca en un panel de ejemplo.
      </p>

      <ol class="list-decimal list-inside text-sm text-gray-600 dark:text-gray-300 space-y-2 mt-3">
        <li>
          <strong>Define tokens en <code>@layer theme</code></strong>:
          <ul class="list-disc list-inside ml-4">
            <li><code>--color-brand</code> para tu color principal.</li>
            <li>Opcional: <code>--radius-card</code> y <code>--shadow-card</code> para radio y sombra por defecto.</li>
          </ul>
          <span class="text-xs text-gray-500">
            Docs: <a class="underline" href="https://tailwindcss.com/docs/adding-custom-styles#theme" target="_blank" rel="noreferrer">Theme variables</a>
          </span>
        </li>
        <li>
          <strong>Crea componentes en <code>@layer components</code></strong>:
          <ul class="list-disc list-inside ml-4">
            <li><code>.badge</code>: pastilla accesible con buen contraste y padding.</li>
            <li><code>.panel</code>: tarjeta neutra con borde, sombra y radio desde tokens.</li>
          </ul>
          <span class="text-xs text-gray-500">
            Docs: <a class="underline" href="https://tailwindcss.com/docs/adding-custom-styles#using-apply" target="_blank" rel="noreferrer">Using @apply</a>
          </span>
        </li>
        <li>
          <strong>(Opcional) Añade una utilidad en <code>@layer utilities</code></strong>:
          <span class="text-xs text-gray-500">
            Docs: <a class="underline" href="https://tailwindcss.com/docs/adding-custom-styles#adding-custom-css" target="_blank" rel="noreferrer">Adding custom CSS</a>
          </span>
        </li>
        <li>
          <strong>Prueba tu biblioteca</strong>: coloca dos <code>.badge</code> y un <code>.panel</code> en esta página. Revisa contraste en modo claro/oscuro.
          <span class="text-xs text-gray-500">
            Docs: <a class="underline" href="https://tailwindcss.com/docs/dark-mode" target="_blank" rel="noreferrer">Dark mode</a>
          </span>
        </li>
        <li>
          <strong>Criterios de éxito</strong>:
          <ul class="list-disc list-inside ml-4">
            <li>Los tokens funcionan (puedes usar <code>text-brand</code>, <code>bg-brand</code>).</li>
            <li>Los componentes se ven consistentes y responden a <code>hover</code>/<code>focus-visible</code>.</li>
            <li>El panel mantiene legibilidad en claro y oscuro.</li>
          </ul>
        </li>
      </ol>

      <pre class="mt-4 p-4 bg-gray-100 dark:bg-gray-900 rounded text-xs overflow-x-auto"><code>/* src/style.css — guía de implementación */
@import "tailwindcss";

/* 1) Tokens del tema */
@layer theme {
  @theme {
    --color-brand: #2563eb;
    --radius-card: 0.75rem;
    --shadow-card: var(--shadow-md);
  }
}

/* 2) Componentes reusables */
@layer components {
  .badge {
    @apply inline-flex items-center gap-1 px-3 py-1 text-xs font-semibold
           rounded-full bg-brand/10 text-brand;
  }

  .panel {
    @apply bg-white dark:bg-slate-900 border border-gray-200 dark:border-gray-800
           shadow rounded-[--radius-card] p-4;
  }
}

/* 3) (Opcional) Utilidad personalizada */
@layer utilities {
  .shadow-glow {
    box-shadow:
      0 1px 2px 0 oklch(0 0 0 / 0.05),
      0 0 0 4px color-mix(in oklab, var(--color-brand) 15%, transparent);
  }
}
</code></pre>

      <div class="mt-4 rounded-lg border border-dashed border-gray-300 dark:border-gray-700 p-4 space-y-3">
        <div class="flex flex-wrap gap-2">
          <span class="badge">Token personalizado</span>
          <span class="badge bg-emerald-100 text-emerald-700">Accesible</span>
        </div>

        <div class="panel shadow-glow">
          <h3 class="text-lg font-bold">Panel con tokens y componentes</h3>
          <p class="text-sm text-gray-600 dark:text-gray-300">
            Este bloque usa <code>@theme</code> (color/radio/sombra) y componentes en
            <code>@layer components</code>. Ajusta tokens y observa cómo impactan globalmente.
          </p>
        </div>

        <p class="text-xs text-gray-500 dark:text-gray-400">
          Más info: 
          <a class="underline" href="https://tailwindcss.com/docs/adding-custom-styles" target="_blank" rel="noreferrer">Adding custom styles</a> ·
          <a class="underline" href="https://tailwindcss.com/docs/dark-mode" target="_blank" rel="noreferrer">Dark mode</a> ·
          <a class="underline" href="https://tailwindcss.com/docs/hover-focus-and-other-states" target="_blank" rel="noreferrer">States</a>
        </p>
      </div>

      <div class="mt-4">
        <h3 class="text-sm font-semibold">Errores comunes a evitar</h3>
        <ul class="list-disc list-inside text-sm text-gray-600 dark:text-gray-300 mt-1">
          <li>Declarar clases dentro de <code>@theme</code>. Solo acepta custom properties y <code>@keyframes</code>.</li>
          <li>Construir nombres de clase dinámicos que el escáner no pueda detectar.</li>
          <li>Olvidar <code>focus-visible</code> en botones/enlaces (accesibilidad).</li>
        </ul>
      </div>
    </section>
  </main>

  <script>
    const menuBtn = document.getElementById('menu-btn');
    const menu = document.getElementById('menu');
    if (menuBtn) menuBtn.addEventListener('click', () => menu.classList.toggle('hidden'));

    // Active link
    const currentPath = window.location.pathname;
    document.querySelectorAll('nav a').forEach((link) => {
      if (link.getAttribute('href') === currentPath) {
        link.classList.add('font-bold', 'text-brand');
      }
    });
  </script>
</body>
</html>
